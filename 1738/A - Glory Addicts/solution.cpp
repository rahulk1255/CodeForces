#include <bits/stdc++.h>using namespace std; int main() {    ios::sync_with_stdio(false);    cin.tie(nullptr);     int t;    cin >> t;    while (t--) {        int n;        cin >> n;         vector<long long> a(n), b(n);        for (int i = 0; i < n; i++) cin >> a[i];        for (int i = 0; i < n; i++) cin >> b[i];         vector<long long> fire, frost;         for (int i = 0; i < n; i++) {            if (a[i] == 0) fire.push_back(b[i]);            else frost.push_back(b[i]);        }         sort(fire.begin(), fire.end(), greater<long long>());        sort(frost.begin(), frost.end(), greater<long long>());         long long sum = 0;         for (long long x : fire) sum += x;        for (long long x : frost) sum += x;         int f = fire.size();        int g = frost.size();        int k = min(f, g);         if (k == 0) {            cout << sum << '\n';            continue;        }         long long extra = 0;         for (int i = 0; i < k; i++) {            extra += fire[i];            extra += frost[i];        }         if (f == g) {            extra -= min(fire[k - 1], frost[k - 1]);        }         cout << sum + extra << '\n';    }    return 0;}